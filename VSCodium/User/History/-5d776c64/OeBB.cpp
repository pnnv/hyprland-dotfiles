#include <bits/stdc++.h>
using namespace std;

typedef long long ll;

int32_t main() {
	ios::sync_with_stdio(false); cin.tie(0);
	
	int n; cin >> n;
	string s, t; cin >> s >> t;
	
	ll pp = 0, fin = 0, ptr = 2;
	for(int i = n - 1; i >= 0; i--, ptr++) {
		if(s[i] == 'W') pp ^= (1LL << ptr);
		if(t[i] == 'W') fin ^= (1LL << ptr);
	}

	if(__popcount(pp) != __popcount(fin) && cout << -1 << endl)
		return 0;

	vector <vector <ll>> vis(1LL << (n + 2), vector <ll> (n + 1, -1));

	queue <pair <ll, ll>> q;
	q.push({pp, 0}); vis[pp][0] = 0;

	while(!q.empty()) {
		ll c = q.front().first, x = q.front().second; q.pop();
		cout << bitset <16> (c) << "| " << x <<  ": ";
		for(int i = 0; i < n; i++) {
			if(abs(i - x) <= 1) continue;
			ll tc = c;
			if((c >> i) & 1LL) {
				tc |= (1LL << x);
				tc ^= (1LL << i);
			}
			if((c >> (i + 1)) & 1LL) {
				tc |= (1LL << (x + 1LL));
				tc ^= (1LL << (i + 1LL));
			}

			if(vis[tc][i] == -1) {
				q.push({tc, i});
				vis[tc][i] = vis[c][x] + 1;
				if(tc == fin && x == 0 && cout << vis[tc][0] << endl)
					return 0; 
			}

			cout << bitset <16> (tc) << ' ';
		}
		cout  << endl;
	}
	cout << -1 << endl;
}

/*

0000000001010100| 0: 0000000001010001 0000000001000110 0000000001000101 0000000000010110 
0000000001010001| 2: 0000000001010100 0000000001000101 0000000000011001 
0000000001000110| 3: 0000000001010100 0000000001011000 0000000000010110 
0000000001000101| 4: 0000000001010100 0000000001100001 0000000001010001 
0000000000010110| 5: 0000000001010100 0000000001110000 0000000000110010 0000000001000110 
0000000000011001| 5: 0000000000111000 0000000000011001 0000000001010001 0000000001100001 
0000000001011000| 1: 0000000001000110 0000000001001010 0000000000011100 
0000000001100001| 1: 0000000001100001 0000000001000101 0000000000000111 
0000000001110000| 1: 0000000001100100 0000000001000110 0000000000010110 
0000000000110010| 2: 0000000000111000 0000000000001110 0000000000010110 
0000000000111000| 0: 0000000000110010 0000000000100011 0000000000001011 0000000000011001 
0000000000011001| 1: 0000000000000111 0000000000001011 0000000000011001 
0000000001100001| 3: 0000000001101000 0000000001100001 0000000000011001 
0000000001001010| 4: 0000000001101000 0000000001011000 0000000001100010 
0000000000011100| 5: 0000000000011100 0000000001011000 0000000001110000 0000000001100100 
0000000000000111| 5: 0000000001100100 0000000001100001 0000000000100011 0000000000000111 
0000000001100100| 3: 0000000001100100 0000000001110000 0000000000011100 
0000000001000110| 4: 0000000001100100 0000000001110000 0000000001010010 
0000000000001110| 4: 0000000000101100 0000000000111000 0000000000110010 
0000000000100011| 3: 0000000000111000 0000000000101001 0000000000001011 
0000000000001011| 4: 0000000000111000 0000000000011001 0000000000100011 
0000000000000111| 3: 0000000000011100 0000000000011001 0000000000000111 
0000000001101000| 0: 0000000001100010 0000000001100001 0000000001001010 0000000000001011 
0000000001100010| 2: 0000000001101000 0000000001001010 0000000000001110 
0000000000011100| 0: 0000000000010011 0000000000000111 0000000000001101 0000000000011100 
0000000001110000| 2: 0000000001110000 0000000001001100 0000000000011100 
0000000001100100| 0: 0000000001100001 0000000001100100 0000000001000110 0000000000000111 
0000000000100011| 2: 0000000000101100 0000000000001011 0000000000000111 
0000000001010010| 2: 0000000001011000 0000000001000110 0000000000011010 
0000000000101100| 0: 0000000000100011 0000000000100101 0000000000001110 0000000000001101 
0000000000111000| 1: 0000000000100110 0000000000001110 0000000000011010 
0000000000101001| 1: 0000000000100011 0000000000001101 0000000000001011 
0000000000001011| 5: 0000000001101000 0000000000101001 0000000001000011 0000000000100011 
0000000000001110| 5: 0000000001001100 0000000001101000 0000000001100010 0000000000100110 
0000000000010011| 2: 0000000000011100 0000000000000111 0000000000010011 
0000000000001101| 4: 0000000000011100 0000000000101001 0000000000110001 
0000000001110000| 0: 0000000001110000 0000000001100010 0000000001000011 0000000000010011 
0000000001001100| 4: 0000000001001100 0000000001101000 0000000001110000 
0000000001100001| 2: 0000000001100100 0000000001001001 0000000000001101 
0000000001011000| 0: 0000000001010010 0000000001000011 0000000001001001 0000000000011010 
0000000000011010| 5: 0000000001011000 0000000000111000 0000000001010010 0000000001100010 
0000000000100101| 3: 0000000000101100 0000000000110001 0000000000001101 
0000000000001101| 5: 0000000000101100 0000000001001001 0000000001100001 0000000000100101 
0000000000100110| 3: 0000000000110100 0000000000111000 0000000000001110 
0000000001000011| 2: 0000000001001100 0000000001000011 0000000000001011 
0000000001001100| 0: 0000000001000011 0000000001000101 0000000001001100 0000000000001110 
0000000001101000| 1: 0000000001100010 0000000001001100 0000000000001110 
0000000000000111| 4: 0000000000110100 0000000000110001 0000000000010011 
0000000000010011| 5: 0000000001110000 0000000000110001 0000000000010011 0000000001000011 
0000000000110001| 2: 0000000000110100 0000000000001101 0000000000010101 
0000000001100010| 3: 0000000001110000 0000000001101000 0000000000011010 
0000000001000011| 4: 0000000001110000 0000000001010001 0000000001000011 
0000000001001001| 4: 0000000001011000 0000000001001001 0000000001100001 
0000000001000011| 3: 0000000001011000 0000000001001001 0000000000010011 
0000000000110001| 1: 0000000000100101 0000000000000111 0000000000010011 
0000000001001001| 1: 0000000001000011 0000000001001001 0000000000001101 
0000000000110100| 0: 0000000000110001 0000000000100110 0000000000000111 0000000000010101 
0000000001000101| 3: 0000000001001100 0000000001010001 0000000000010101 
0000000000010101| 5: 0000000000110100 0000000001010001 0000000000110001 0000000001000101 
0000000001010001| 1: 0000000001000101 0000000001000011 0000000000010101 
-1


*/